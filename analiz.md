Анализ совместимости зависимостей
Совместимость с Python 3.13
Все перечисленные библиотеки заявляют поддержку Python 3.8+ и выше, поэтому в целом они должны работать на Python 3.13. Например, библиотека librosa уже явно помечена совместимой с Python 3.13
pypi.org
. Однако некоторые пакеты могут требовать наличия скомпилированных колёс (wheels) под новую версию Python. К моменту выхода Python 3.13 большинство крупных проектов (TensorFlow, PyTorch, OpenCV и др.) обычно выпускают соответствующие обновления, так что серьёзных проблем ожидать не должно. Тем не менее, при использовании Python 3.13 стоит убедиться, что вы устанавливаете последние версии пакетов, где исправлены возможные несовместимости.
PyTorch 2.x и Torchvision (CUDA 12.8)
Указанные версии torch>=2.1.0 и torchvision>=0.16.0 должны соответствовать друг другу. В экосистеме PyTorch версии этих пакетов тесно связаны: например, torchvision 0.16.0 требует строго torch 2.1.0
forums.developer.nvidia.com
. Это значит, что если будет установлена другая версия PyTorch (скажем, 2.2 или 2.0), torchvision 0.16 может не работать корректно. Рекомендуется устанавливать torchvision и сам PyTorch согласованно – лучшим решением будет взять совпадающие версии (например, PyTorch 2.1.0 вместе с torchvision 0.16.0)
forums.developer.nvidia.com
. Обратите внимание на поддержку CUDA: PyTorch с версией CUDA 12.8 должен быть установлен соответствующим образом. На момент выхода PyTorch 2.1 официальные колёса поддерживали CUDA вплоть до версии 12.1
reddit.com
. Для CUDA 12.8 может понадобиться более новая версия PyTorch (в 2025 году такие версии, вероятно, уже доступны) или сборка из источников. Убедитесь, что устанавливаете сборку torch, скомпилированную под вашу версию CUDA. В pip это обычно обозначается суффиксом, например +cu121 для CUDA 12.1 и т.п. (для CUDA 12.8 может быть аналогичный сборочный тег, либо придётся использовать релиз PyTorch с поддержкой 12.8). Несоответствие версии CUDA приведёт к тому, что PyTorch не сможет использовать GPU. В остальном, torch и torchvision не конфликтуют с другими библиотеками списка и могут спокойно сосуществовать с TensorFlow и прочими пакетами.
OpenCV: opencv-python vs opencv-contrib-python
В списке указаны две зависимости: opencv-python>=4.9.0 и opencv-contrib-python>=4.9.0. Эти пакеты на самом деле дублируют друг друга и не должны устанавливаться одновременно в одном окружении
stackoverflow.com
stackoverflow.com
. Дело в том, что opencv-contrib-python включает в себя все модули основного opencv-python плюс дополнительные «contrib»-модули (например, нестабильные алгоритмы вроде SIFT, SURF и др.)
stackoverflow.com
. Одновременная установка обоих вариантов может привести к конфликтующим версиям OpenCV. Рекомендация: оставить только один пакет OpenCV. Если вам нужны дополнительные модули (расширенные алгоритмы), используйте opencv-contrib-python той же версии. Этот пакет уже включает весь функционал OpenCV
stackoverflow.com
. Если же доп. модули не нужны и достаточно базового функционала, можно установить только opencv-python. Главное – не устанавливать их вместе
stackoverflow.com
, чтобы избежать непредсказуемых ошибок (например, одна версия может перезаписать файлы другой).
TensorFlow и NumPy
Версия tensorflow>=2.15.0 потенциально конфликтует с требованием numpy>=1.24.0, если не учесть недавние изменения. Дело в том, что в прошлых релизах TensorFlow накладывал ограничение на версию NumPy. Например, TensorFlow 2.12 требовал numpy < 1.24
github.com
. Если бы мы устанавливали TF 2.12 с numpy 1.24+, возникала бы ошибка несовместимости версий. Однако разработчики TensorFlow знали об этой проблеме и планировали снять ограничение в будущих версиях
github.com
. Версия 2.15.0 – более поздняя, и, судя по ходу развития, в ней, вероятно, уже нет жёсткого ограничения на numpy 1.24. Действительно, начиная с TF 2.13+ ограничения на NumPy ослаблялись. К августу 2025 года TensorFlow 2.15 должен нормально работать с numpy 1.24 и выше. Таким образом, конфликт между tensorflow>=2.15.0 и numpy>=1.24.0 маловероятен, при условии что мы устанавливаем актуальные релизы (TensorFlow будет совместим с актуальной версией NumPy). Тем не менее, стоит устанавливать TensorFlow до ручного обновления numpy, либо вместе, чтобы pip подобрал совместимую комбинацию. Если вдруг после установки будет предупреждение о конфликте numpy, можно попробовать понизить/повысить версию numpy в пределах 1.24.x – но, повторимся, для TF 2.15+ это обычно не требуется.
Библиотеки DeepFace и FER (Face Recognition)
В проекте задействованы две библиотеки для анализа лиц: DeepFace (>=0.0.79) и FER (>=22.5.0). Оба пакета зависят от фреймворков глубокого обучения и некоторых общих ресурсов, поэтому важно учесть их совместимость с остальными компонентами.
DeepFace – это обёртка над несколькими моделями распознавания лиц. Она требует наличия TensorFlow (или Keras) в окружении. Согласно спецификации, DeepFace 0.0.79 зависит от tensorflow>=1.9.0
stackoverflow.com
, то есть любая современная версия TensorFlow 2.x её устраивает. Прямого конфликта по версиям здесь нет – наш TensorFlow 2.15 удовлетворяет этому требованию. Однако возникал практический конфликт: сообщалось, что DeepFace (версий ~0.0.79–0.0.88) не работал с TensorFlow 2.15.0
stackoverflow.com
. На Stack Overflow пользователи отмечали, что при TF 2.15 DeepFace выдавал ошибки, и решением было откатить TensorFlow до 2.14
stackoverflow.com
. Это означает, что код DeepFace мог использовать устаревшие API, убранные или изменённые в TF 2.15. Решение: Убедиться, что используется актуальная версия DeepFace. В PyPI уже есть версии DeepFace 0.0.88 и 0.0.93, где многие проблемы исправлены. Поскольку в requirements стоит deepface>=0.0.79, при установке вы получите самую новую версию. Последние релизы DeepFace должны поддерживать и TensorFlow 2.15+, по крайней мере, в примерах DeepFace 0.0.93 успешно работал с TensorFlow 2.17
github.com
kaggle.com
. Если же по каким-то причинам приходится использовать DeepFace 0.0.79, то при проблемах с TF 2.15 придётся либо снизить версию TensorFlow (например, до 2.14, как советовали на Stack Overflow), либо обновить DeepFace. В целом же, при условии обновления, DeepFace и TensorFlow 2.15 совместимы.
FER (Facial Emotion Recognition) – библиотека для определения эмоций по лицу. Она построена на Keras/TensorFlow и использует модель, поставляемую в составе пакета. Согласно документации, FER требует TensorFlow>=1.7.0 и OpenCV>=3.2
pypi.org
. Эти требования легко удовлетворяются: TensorFlow 2.15 и OpenCV 4.9 значительно новее минимума. Таким образом, FER совместим с текущим набором зависимостей. Библиотека FER будет использовать ту же установленную версию OpenCV (cv2) и TensorFlow, никаких отдельных конфликтующих требований у неё нет. Главное – как раз наличие OpenCV и TF, которые мы уже включили. Имейте в виду, что FER по умолчанию использует каскады Хаара OpenCV для обнаружения лиц; альтернативно можно включить MTCNN, что потребует установку дополнительного пакета mtcnn, но в требованиях он не указан. Если понадобится MTCNN, его придётся установить вручную, однако это не влияет на совместимость основных пакетов.
Прочие зависимости
Остальные перечисленные библиотеки, как правило, совместимы друг с другом и с вышеперечисленными фреймворками:
Pandas 2.1.0, SciPy 1.11.0, Scikit-learn 1.3.0, Seaborn 0.13.0, Matplotlib 3.8.0 – это научный питоновский стек, построенный на базе NumPy. Их указанные версии являются современными и рассчитаны на работу с новыми версиями NumPy (1.24+) и Python (до 3.11+, вероятно и 3.13). Эти библиотеки активно поддерживаются, и между собой у них совместимые требования. Например, scikit-learn 1.3 требует numpy >=1.17 и scipy >=1.5, что выполняется у нас. Конфликты маловероятны, если все берутся свежими версиями. Важно лишь не иметь в окружении старых версий этих пакетов – но в requirements.txt явно указаны новые, так что pip поставит подходящие версии.
NumPy 1.24+ мы уже обсудили выше в контексте TensorFlow. С остальными научными библиотеками NumPy 1.24+ полностью совместим. Если все пакеты свежие, они будут собраны под актуальную версию NumPy, и проблем не возникнет. (В редких случаях может появиться предупреждение, например, о deprecated-символах типа np.complex в старом коде – были сообщения о таком предупреждении в связке librosa + numpy 1.25
community.openai.com
, но это не приводит к падению, только предупреждение о будущем изменении.)
Streamlit 1.31.0 – фреймворк веб-интерфейса. Он написан на чистом Python и требует определённые версии Tornado, watchdog и проч., но они устанавливаются автоматически. Streamlit не конфликтует с научными библиотеками; его можно использовать совместно с ними (например, для отображения графиков Plotly или Matplotlib). В данном списке версия свежая, больших известных проблем нет.
Plotly 5.18.0 – библиотека для интерактивной графики. Зависит от других пакетов (например, tenacity, packaging, возможно retrying), но эти зависимости не пересекаются конфликтообразующим образом с остальными. Plotly спокойно устанавливается вместе с Pandas, NumPy и т.д. (часто используется совместно для построения графиков). Версия 5.18 актуальна под 2025 год, и она совместима с Python 3.13 (Plotly обычно поддерживает новые версии Python быстро).
OpenAI API 1.10.0 – библиотека openai предназначена для работы с удалёнными сервисами OpenAI. Внутри она использует requests, aiohttp и другие вспомогательные пакеты. Здесь конфликты маловероятны: версии запросов, совместимых с openai, не мешают другим библиотекам. Главное – иметь интернет-соединение и актуальный python-dotenv (что у нас есть) для загрузки API-ключей из .env, если нужно. Версия 1.10.0 – достаточно новая, она поддерживает Python 3.13 (OpenAI API требует Python>=3.7). В общем, эта библиотека изолирована и не влияет на остальные, кроме как добавляет зависимости типа requests.
Librosa 0.10.1 и аудио-зависимости: librosa – библиотека для аудиоанализа, зависит от SoundFile (pysoundfile), audioread, NumPy, SciPy, scikit-learn (для некоторых функций) и Numba (для ускорения) и т.д. В нашем requirements уже указаны soundfile>=0.12.1 и необходимые NumPy/SciPy, что хорошо. Pip при установке librosa подтянет недостающие пакеты автоматически (например, audioread и numba, если они не указаны вручную). Эти зависимости совместимы с остальными: numba работает с нашей версией numpy (вышел numba 0.61+ с поддержкой numpy 1.24, конфликтов быть не должно). SoundFile потребует библиотеку libsndfile – она обычно включена в колесо soundfile для Windows/macOS, а на Linux нужно иметь системный libsndfile.so. Так как в списке есть python-ffmpeg>=2.0.0, можно предположить, что ffmpeg/авдио подсистема тоже предусмотрена. Важно: убедитесь, что libsndfile установлен (для Linux) или используйте wheels. Но это не конфликт версий, а требование для воспроизведения/чтения аудио. В целом librosa с заданными версиями numpy/scipy/pandas/soundfile будет работать без проблем.
python-ffmpeg 2.0.0 – Python-обёртка для FFmpeg. Она независима и не конфликтует с другими пакетами. Её наличие указывает, что вам, возможно, нужны функции обработки видео/звук через ffmpeg. Убедитесь, что сам исполняемый ffmpeg установлен в системе, поскольку python-ffmpeg лишь вызывает его. Конфликтов с opencv или librosa нет – они могут сосуществовать (OpenCV тоже может использовать ffmpeg для видео, но через свои внутренние привязки; это не мешает использованию python-ffmpeg).
pyyaml 6.0.1, python-dotenv 1.0.0, tqdm 4.66.0, Pillow 10.2.0, colorama 0.4.6, psutil 5.9.0 – эти утилитарные библиотеки также широко совместимы. pyyaml может использоваться, например, библиотекой ultralytics (для чтения YAML-конфигов YOLO) – версия 6.0.1 актуальна и не конфликтует ни с чем. Pillow 10.2.0 (библиотека для работы с изображениями) понадобится, если, скажем, Streamlit или DeepFace будут открывать/преобразовывать изображения – эта версия новейшая и обычно совместима с OpenCV (они могут совместно использоваться). В редких случаях OpenCV и Pillow могут бороться за декодирование изображений, но это не конфликт пакетов, а нюансы использования (например, OpenCV читает BGR, Pillow – RGB; но это решается кодом). tqdm – прогресс-бары, colorama – цветной вывод консоли, psutil – информация о системе. Эти пакеты самодостаточны и не вызывают конфликтов с другими библиотеками.
Вывод и общие рекомендации
В целом, все перечисленные зависимости могут быть установлены совместно при условии соблюдения описанных нюансов:
Не дублировать пакеты: исключить двойную установку OpenCV (выбрать один вариант). Аналогично, следить за тем, чтобы не было разных версий одного и того же пакета одновременно.
Согласовать версии PyTorch экосистемы: устанавливать совместимые версии torch и torchvision (и потенциально torchaudio, если бы он использовался) под нужную версию CUDA. Например, для CUDA 12.8 взять соответствующий релиз PyTorch (к моменту 2025 г. он должен быть). Несоответствие версии CUDA и сборки PyTorch недопустимо – в противном случае пакет torchFallback перейдёт в CPU-режим или выдаст ошибку.
Обновлять до последних патчей: использовать последние патчи/минорные версии библиотек. Многие конфликты (TensorFlow vs NumPy, DeepFace vs TensorFlow и др.) решались в обновлениях. Указанные требования используют >=, что позволит установить более новые версии по мере их выхода. Это правильно – не фиксировать старые версии без необходимости.
Проверять pip install на конфликты: После составления requirements.txt стоит выполнить pip install -r requirements.txt и посмотреть выход. pip сейчас умеет обнаруживать несовместимые зависимости. Если что-то несовместимо, он сообщит об этом. Например, он бы сообщил, если torchvision требовал бы другой torch. В наших зависимостях явных противоречий версий нет, так что установка должна пройти успешно.
Тестирование: После установки желательно протестировать ключевые компоненты: запустить импорт TensorFlow и PyTorch (убедиться, что они оба видят GPU, если нужно), проверить, что DeepFace может загрузить модель (например, DeepFace.analyze на изображении), что FER.detect_emotions работает, что YOLO от ultralytics загружается и выполняет инференс. Это гарантирует, что все библиотеки действительно корректно функционируют вместе.
Следуя этим рекомендациям, вы получите рабочую среду. Если какие-то конфликты все же появятся, их можно решать точечно: либо подбором совместимой версии, либо обращением к документации/сообществу по конкретной ошибке. Но на основании текущего анализа, прямых несовместимостей в списке нет, кроме упомянутой ситуации с двойным OpenCV и потенциальной необходимости обновления DeepFace или ограничения версии TF. Все остальные пакеты должны устанавливаться и работать совместно без проблем.